generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

enum ReviewGroup {
  Movies
  Books
  Games
}

model User {
  id       String    @id @default(uuid())
  username String    @unique
  email    String    @unique
  password String
  isAdmin  Boolean   @default(false)
  reviews  Review[]
  comments Comment[]
  likes    Like[]
}

model Review {
  id    String      @id @default(uuid())
  title String
  item  String
  group ReviewGroup
  tags  Tag[]
  text  String
  grade Int

  author   User   @relation(fields: [authorId], references: [id])
  authorId String

  likes    Like[]
  comments Comment[]

  @@index([authorId])
}

model Tag {
  id      String   @id @default(uuid())
  name    String   @unique
  reviews Review[]
}

model Like {
  id       Int    @id @default(autoincrement())
  user     User   @relation(fields: [userId], references: [id])
  userId   String
  review   Review @relation(fields: [reviewId], references: [id])
  reviewId String

  @@index([userId])
  @@index([reviewId])
}

model Comment {
  id       String @id @default(uuid())
  text     String
  review   Review @relation(fields: [reviewId], references: [id])
  reviewId String
  author   User   @relation(fields: [authorId], references: [id])
  authorId String

  @@index([reviewId])
  @@index([authorId])
}

// Piece entity (optional)
// model Piece {
//   id        Int       @id @default(autoincrement())
//   name      String
//   // Add other fields related to the piece as needed
//   reviews   Review[]  // One-to-many relationship with reviews
// }
